var Shortcuts={special:{'backspace':8,'tab':9,'enter':13,'pause':19,'capslock':20,'esc':27,'space':32,'pageup':33,'pagedown':34,'end':35,'home':36,'left':37,'up':38,'right':39,'down':40,'insert':45,'delete':46,'f1':112,'f2':113,'f3':114,'f4':115,'f5':116,'f6':117,'f7':118,'f8':119,'f9':120,'f10':121,'f11':122,'f12':123,'?':191},lists:{},pressed:{},start:function(){var a=this;$(document).bind($.browser.opera?'keypress':'keydown',function(e){if(!a.pressed[e.which]){a.runShortcuts('down',e)}a.pressed[e.which]=true;a.runShortcuts('hold',e)});$(document).bind('keyup',function(e){a.pressed[e.which]=false;a.runShortcuts('up',e)})},add:function(a){if(!a.mask){throw new Error("Shortcuts.add: required parameter 'params.mask' is undefined.");}if(!a.handler){throw new Error("Shortcuts.add: required parameter 'params.handler' is undefined.");}if(!a.type){a.type='down'}if(!a.list){a.list='default'}var b=this.getMaskObject(a.mask);var c=this.getKey(a.type,b);if(!this.lists[a.list]){this.lists[a.list]={}}var d=this.lists[a.list];if(!d[c]){d[c]=[]}d[c].push(a);if(!this.activeList){this.setList(a.list)}},remove:function(a){if(!a.mask){throw new Error("Shortcuts.add: required parameter 'params.mask' is undefined.");}if(!a.type){a.type='down'}if(!a.list){a.list='default'}if(this.lists[a.list]){var b=this.getMaskObject(a.mask);var c=this.getKey(a.type,b);delete this.lists[a.list][c]}},setList:function(a){this.activeList=this.lists[a]},getKey:function(a,b){var c='';c+=a;if(b.ctrl){c+='_ctrl'}if(b.alt){c+='_alt'}if(b.shift){c+='_shift'}if(b.which&&b.which!==16&&b.which!==17&&b.which!==18){c+='_'+b.which}return c},getMaskObject:function(a){var b={};var c=a.toLowerCase().replace(/\s+/g,'').split(/\+/);var d;for(var i=0,len=c.length;i<len;i+=1){d=c[i];if(d==='ctrl'||d==='alt'||d==='shift'){b[d]=true}else{b.which=this.special[d]||d.toUpperCase().charCodeAt()}}return b},runShortcuts:function(a,e){if(!this.activeList){return}var b={ctrl:e.ctrlKey,alt:e.altKey,shift:e.shiftKey,which:e.which};var c=this.isInput(e.target);var d=this.getKey(a,b);var f=this.activeList[d];if(f&&f.length>0){e.preventDefault();for(var i=0,len=f.length;i<len;i+=1){if(!c||f[i].enableInInput){f[i].handler()}}}},isInput:function(a){var b=a.tagName.toLowerCase();var c=a.type;if((b==='input'&&(c==='text'||c==='password'||c==='file'||c==='search'))||b==='textarea'){return true}else{return false}}};