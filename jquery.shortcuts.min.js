(function(e){var o={backspace:8,tab:9,enter:13,pause:19,capslock:20,esc:27,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,"delete":46,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,"?":191},f={},g={},h=false,i,j=function(a,b){var c="";c+=a;if(b.ctrl)c+="_ctrl";if(b.alt)c+="_alt";if(b.shift)c+="_shift";if(b.which&&b.which!==16&&b.which!==17&&b.which!==18)c+="_"+b.which;return c},l=function(a){var b={};a=a.split("+");e.each(a,function(c,d){if(d==="ctrl"||d==="alt"||d==="shift")b[d]=true;else b.which=o[d]||d.toUpperCase().charCodeAt()});return b},p=function(a){var b=a.tagName.toLowerCase();a=a.type;return b==="input"&&(a==="text"||a==="password"||a==="file"||a==="search")||b==="textarea"?true:false},k=function(a,b){if(i){var c={ctrl:b.ctrlKey,alt:b.altKey,shift:b.shiftKey,which:b.which},d=p(b.target);a=j(a,c);if(a=i[a]){var m=false;e.each(a,function(q,n){if(!d||n.enableInInput){if(!m){b.preventDefault();m=true}n.handler(b)}})}}};e.Shortcuts={};e.Shortcuts.start=function(a){a=a||"default";i=f[a];if(!h){e(document).bind((e.browser.opera?"keypress":"keydown")+".shortcuts",function(b){if(b.type==="keypress"&&b.which>=97&&b.which<=122)b.which-=32;g[b.which]||k("down",b);g[b.which]=true;k("hold",b)});e(document).bind("keyup.shortcuts",function(b){g[b.which]=false;k("up",b)});h=true}};e.Shortcuts.stop=function(){e(document).unbind("keypress.shortcuts keydown.shortcuts keyup.shortcuts");h=false};e.Shortcuts.add=function(a){if(!a.mask)throw new Error("$.Shortcuts.add: required parameter 'params.mask' is undefined.");if(!a.handler)throw new Error("$.Shortcuts.add: required parameter 'params.handler' is undefined.");a.type=a.type||"down";a.list=a.list||"default";var b=a.mask.toLowerCase().replace(/\s+/g,"").split(",");e.each(b,function(c,d){c=l(d);c=j(a.type,c);f[a.list]||(f[a.list]={});d=f[a.list];d[c]||(d[c]=[]);d[c].push(a)})};e.Shortcuts.remove=function(a){if(!a.mask)throw new Error("$.Shortcuts.remove: required parameter 'params.mask' is undefined.");a.type=a.type||"down";a.list=a.list||"default";if(f[a.list]){var b=a.mask.toLowerCase().replace(/\s+/g,"").split(",");e.each(b,function(c,d){c=l(d);c=j(a.type,c);delete f[a.list][c]})}}})(jQuery);